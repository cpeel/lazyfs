# Test: 
#
# Commands:
#
#   ./setup-testbed.sh -d /tmp/lazyfs/fb-workload -f fileserver.f.f
#   filebench -f fileserver.f.f
#
# Description:
#
#   (Using standard page size in cache - 4kb / 4096 bytes)
# 
#   1. Clear all files from FS
#   2. Run filebench fileserver.f.f
#   3. Get results

# Run 1


# Run 2


# Run 3


# lazyfs run number 1

Filebench Version 1.5-alpha3
0.000: Allocated 177MB of shared memory
0.005: File-server Version 3.0 personality successfully loaded
0.005: performing a checkpoint...
0.005: Sleeping...
10.007: Slept for 10 seconds...
10.007: clearing cached data...
10.009: Sleeping...
20.011: Slept for 10 seconds...
20.038: time sync
time sync 1651241623.012727615
20.048: time sync
20.048: current cache usage...
20.049: Populating and pre-allocating filesets
20.060: bigfileset populated: 10000 files, avg. dir. width = 20, avg. dir. depth = 3.1, 0 leafdirs, 1240.757MB total size
20.061: Removing bigfileset tree (if exists)
20.063: Pre-allocating directories in bigfileset tree
20.103: Pre-allocating files in bigfileset tree
30.455: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
30.455: Population and pre-allocation of filesets completed
30.455: Starting 1 filereader instances
31.748: Running...
331.768: Run took 300 seconds...
331.768: Per-Operation Breakdown
statfile1            43548ops      145ops/s   0.0mb/s    0.044ms/op [0.016ms - 7.134ms]
deletefile1          43548ops      145ops/s   0.0mb/s    0.325ms/op [0.113ms - 7.072ms]
closefile3           43548ops      145ops/s   0.0mb/s    0.005ms/op [0.002ms - 0.039ms]
readfile1            43548ops      145ops/s  18.5mb/s    0.832ms/op [0.034ms - 7.956ms]
openfile2            43548ops      145ops/s   0.0mb/s    0.121ms/op [0.035ms - 5.522ms]
closefile2           43548ops      145ops/s   0.0mb/s    0.006ms/op [0.001ms - 0.032ms]
appendfilerand1      43548ops      145ops/s   1.1mb/s    0.301ms/op [0.062ms - 7.471ms]
openfile1            43548ops      145ops/s   0.0mb/s    0.119ms/op [0.035ms - 6.763ms]
closefile1           43548ops      145ops/s   0.0mb/s    0.007ms/op [0.002ms - 0.115ms]
wrtfile1             43548ops      145ops/s  18.2mb/s    4.880ms/op [0.111ms - 46.711ms]
createfile1          43549ops      145ops/s   0.0mb/s    0.185ms/op [0.081ms - 20.700ms]
331.768: IO Summary: 479029 ops 1596.658 ops/s 145/290 rd/wr  37.9mb/s 0.621ms/op
331.768: Shutting down processes

# lazyfs run number 2

Filebench Version 1.5-alpha3
0.000: Allocated 177MB of shared memory
0.001: File-server Version 3.0 personality successfully loaded
0.001: performing a checkpoint...
0.002: Sleeping...
10.003: Slept for 10 seconds...
10.003: clearing cached data...
10.005: Sleeping...
20.007: Slept for 10 seconds...
20.037: time sync
time sync 1651241980.980171466
20.048: time sync
20.048: current cache usage...
20.048: Populating and pre-allocating filesets
20.060: bigfileset populated: 10000 files, avg. dir. width = 20, avg. dir. depth = 3.1, 0 leafdirs, 1240.757MB total size
20.060: Removing bigfileset tree (if exists)
20.062: Pre-allocating directories in bigfileset tree
20.109: Pre-allocating files in bigfileset tree
32.205: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
32.206: Population and pre-allocation of filesets completed
32.206: Starting 1 filereader instances
33.224: Running...
333.244: Run took 300 seconds...
333.244: Per-Operation Breakdown
statfile1            42331ops      141ops/s   0.0mb/s    0.045ms/op [0.015ms - 1.585ms]
deletefile1          42331ops      141ops/s   0.0mb/s    0.332ms/op [0.110ms - 4.675ms]
closefile3           42331ops      141ops/s   0.0mb/s    0.006ms/op [0.001ms - 0.034ms]
readfile1            42331ops      141ops/s  18.0mb/s    0.858ms/op [0.033ms - 8.874ms]
openfile2            42331ops      141ops/s   0.0mb/s    0.125ms/op [0.035ms - 6.001ms]
closefile2           42331ops      141ops/s   0.0mb/s    0.006ms/op [0.001ms - 0.041ms]
appendfilerand1      42331ops      141ops/s   1.1mb/s    0.310ms/op [0.054ms - 6.641ms]
openfile1            42331ops      141ops/s   0.0mb/s    0.124ms/op [0.034ms - 7.362ms]
closefile1           42331ops      141ops/s   0.0mb/s    0.007ms/op [0.002ms - 0.039ms]
wrtfile1             42331ops      141ops/s  17.7mb/s    5.016ms/op [0.115ms - 46.957ms]
createfile1          42332ops      141ops/s   0.0mb/s    0.192ms/op [0.079ms - 11.560ms]
333.244: IO Summary: 465642 ops 1552.037 ops/s 141/282 rd/wr  36.8mb/s 0.638ms/op
333.244: Shutting down processes

# lazyfs run number 3

Filebench Version 1.5-alpha3
0.000: Allocated 177MB of shared memory
0.001: File-server Version 3.0 personality successfully loaded
0.001: performing a checkpoint...
0.002: Sleeping...
10.003: Slept for 10 seconds...
10.003: clearing cached data...
10.005: Sleeping...
20.007: Slept for 10 seconds...
20.036: time sync
time sync 1651242340.433418859
20.047: time sync
20.047: current cache usage...
20.047: Populating and pre-allocating filesets
20.058: bigfileset populated: 10000 files, avg. dir. width = 20, avg. dir. depth = 3.1, 0 leafdirs, 1240.757MB total size
20.058: Removing bigfileset tree (if exists)
20.060: Pre-allocating directories in bigfileset tree
20.105: Pre-allocating files in bigfileset tree
31.252: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
31.252: Population and pre-allocation of filesets completed
31.252: Starting 1 filereader instances
32.265: Running...
332.285: Run took 300 seconds...
332.286: Per-Operation Breakdown
statfile1            43153ops      144ops/s   0.0mb/s    0.045ms/op [0.015ms - 3.304ms]
deletefile1          43153ops      144ops/s   0.0mb/s    0.330ms/op [0.115ms - 8.338ms]
closefile3           43153ops      144ops/s   0.0mb/s    0.006ms/op [0.002ms - 0.035ms]
readfile1            43153ops      144ops/s  18.3mb/s    0.838ms/op [0.035ms - 8.083ms]
openfile2            43153ops      144ops/s   0.0mb/s    0.122ms/op [0.035ms - 6.130ms]
closefile2           43153ops      144ops/s   0.0mb/s    0.006ms/op [0.001ms - 0.042ms]
appendfilerand1      43153ops      144ops/s   1.1mb/s    0.304ms/op [0.057ms - 4.929ms]
openfile1            43153ops      144ops/s   0.0mb/s    0.121ms/op [0.027ms - 0.910ms]
closefile1           43153ops      144ops/s   0.0mb/s    0.007ms/op [0.002ms - 0.032ms]
wrtfile1             43153ops      144ops/s  18.1mb/s    4.922ms/op [0.117ms - 40.658ms]
createfile1          43154ops      144ops/s   0.0mb/s    0.188ms/op [0.078ms - 27.395ms]
332.286: IO Summary: 474684 ops 1582.174 ops/s 144/288 rd/wr  37.5mb/s 0.626ms/op
332.286: Shutting down processes
