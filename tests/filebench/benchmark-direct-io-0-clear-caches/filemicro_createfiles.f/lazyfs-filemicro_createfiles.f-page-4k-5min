# Test: 
#
# Commands:
#
#   ./setup-testbed.sh -d /tmp/lazyfs/fb-workload -f filemicro_createfiles.f.f
#   filebench -f filemicro_createfiles.f.f
#
# Description:
#
#   (Using standard page size in cache - 4kb / 4096 bytes)
# 
#   1. Clear all files from FS
#   2. Run filebench filemicro_createfiles.f.f
#   3. Get results

# Run 1


# Run 2


# Run 3


# lazyfs run number 1

Filebench Version 1.5-alpha3
0.000: Allocated 177MB of shared memory
0.001: Populating and pre-allocating filesets
0.369: fileset-1 populated: 1000000 files, avg. dir. width = 1000, avg. dir. depth = 2.0, 0 leafdirs, 3906.250MB total size
0.369: Removing fileset-1 tree (if exists)
0.370: Pre-allocating directories in fileset-1 tree
0.443: Pre-allocating files in fileset-1 tree
3.131: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
3.131: Population and pre-allocation of filesets completed
3.131: performing a checkpoint...
3.131: Sleeping...
13.133: Slept for 10 seconds...
13.133: clearing cached data...
13.135: Sleeping...
23.136: Slept for 10 seconds...
23.168: time sync
time sync 1651244879.340717407
23.179: time sync
23.179: current cache usage...
23.179: Attempting to create fileset more than once, ignoring
23.180: Starting 1 process-1 instances
24.188: Running...
110.303: Run took 86 seconds...
110.304: Shutting down processes

# lazyfs run number 2

Filebench Version 1.5-alpha3
0.000: Allocated 177MB of shared memory
0.002: Populating and pre-allocating filesets
0.378: fileset-1 populated: 1000000 files, avg. dir. width = 1000, avg. dir. depth = 2.0, 0 leafdirs, 3906.250MB total size
0.378: Removing fileset-1 tree (if exists)
0.379: Pre-allocating directories in fileset-1 tree
0.430: Pre-allocating files in fileset-1 tree
3.078: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
3.078: Population and pre-allocation of filesets completed
3.078: performing a checkpoint...
3.079: Sleeping...
13.080: Slept for 10 seconds...
13.080: clearing cached data...
13.082: Sleeping...
23.084: Slept for 10 seconds...
23.115: time sync
time sync 1651245016.215029384
23.125: time sync
23.125: current cache usage...
23.126: Attempting to create fileset more than once, ignoring
23.126: Starting 1 process-1 instances
24.133: Running...
108.158: Run took 84 seconds...
108.159: Shutting down processes

# lazyfs run number 3

Filebench Version 1.5-alpha3
0.000: Allocated 177MB of shared memory
0.039: Populating and pre-allocating filesets
0.415: fileset-1 populated: 1000000 files, avg. dir. width = 1000, avg. dir. depth = 2.0, 0 leafdirs, 3906.250MB total size
0.415: Removing fileset-1 tree (if exists)
0.416: Pre-allocating directories in fileset-1 tree
0.487: Pre-allocating files in fileset-1 tree
3.150: Waiting for pre-allocation to finish (in case of a parallel pre-allocation)
3.150: Population and pre-allocation of filesets completed
3.150: performing a checkpoint...
3.150: Sleeping...
13.152: Slept for 10 seconds...
13.152: clearing cached data...
13.154: Sleeping...
23.155: Slept for 10 seconds...
23.190: time sync
time sync 1651245151.088203286
23.201: time sync
23.201: current cache usage...
23.202: Attempting to create fileset more than once, ignoring
23.202: Starting 1 process-1 instances
24.210: Running...
126.274: Run took 100 seconds...
126.416: Per-Operation Breakdown
finishoncount-1      0ops        0ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.000ms]
createwriteclose-1.closefile-1 38934ops      381ops/s   0.0mb/s    0.008ms/op [0.001ms - 1.071ms]
createwriteclose-1.write-1 38934ops      381ops/s   1.5mb/s    1.982ms/op [0.177ms - 5711.784ms]
createwriteclose-1.createfile-1 38934ops      381ops/s   0.0mb/s    0.534ms/op [0.068ms - 1587.353ms]
createwriteclose-1   0ops        0ops/s   0.0mb/s    0.000ms/op [0.000ms - 0.000ms]
126.422: IO Summary: 116802 ops 1143.054 ops/s 0/381 rd/wr   1.5mb/s 0.841ms/op
126.422: Shutting down processes
